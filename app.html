<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mijn Huishouden</title>
    
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- Scripts -->
    <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/emoji-picker-element@^1/index.js"></script>
</head>
<body>

    <!-- Navigatiebalk (Tabs) -->
    <nav class="bottom-nav">
        <button class="nav-item active" data-tab="tab-vriezer">
            <i class="fas fa-snowflake"></i>
            <span>Vriezer</span>
        </button>
        <button class="nav-item" data-tab="tab-voorraad">
            <i class="fas fa-box-open"></i>
            <span>Voorraad</span>
        </button>
        <button class="nav-item" data-tab="tab-boodschappen">
            <i class="fas fa-shopping-cart"></i>
            <span>Lijst</span>
        </button>
        <button class="nav-item" data-tab="tab-weekmenu">
            <i class="fas fa-calendar-alt"></i>
            <span>Menu</span>
        </button>
    </nav>

    <div class="container">
        <!-- Header Bar -->
        <div class="header-bar">
            <h1 id="page-title">Vriezer</h1>
            <div class="header-icons-wrapper">
                <button id="switch-account-knop" class="btn-beheer btn-admin" style="display: none;" title="Wissel Account">
                    <i class="fas fa-users-cog"></i>
                </button>
                <button id="profile-btn" class="profile-btn" title="Profiel">
                    <i class="fas fa-user-circle"></i> 
                    <img id="profile-img" src="" alt="Profiel" style="display: none;">
                </button>
            </div>
        </div>

        <div id="feedback-message" class="feedback"></div>

        <!-- TAB 1: VRIEZER (Hoofdpagina) -->
        <div id="tab-vriezer" class="tab-content active">
            <div id="dashboard" class="dashboard-container"></div>

            <form id="add-item-form">
                <div class="input-with-button" style="grid-column: 1 / 3;">
                    <input type="text" id="item-emoji" class="emoji-trigger" placeholder="ðŸ·ï¸" style="width: 50px; height: 50px; flex-grow: 0; flex-shrink: 0; text-align: center; border-radius: 5px; border: 1px solid #ccc; padding: 0; font-size: 20px; cursor: pointer;" readonly>
                    <input type="text" id="item-naam" placeholder="Productnaam" required list="product-suggesties" style="height: 50px;">
                    <button type="button" id="scan-btn" class="btn-beheer"><i class="fas fa-barcode"></i></button>
                    <button type="button" id="manual-ean-btn" class="btn-beheer"><i class="fas fa-keyboard"></i></button>
                </div>
                <datalist id="product-suggesties"></datalist>

                <div class="aantal-wrapper">
                    <button type="button" class="aantal-btn" data-action="minus">-</button>
                    <input type="number" id="item-aantal" placeholder="1" value="1" step="0.25" min="0.25" required>
                    <button type="button" class="aantal-btn" data-action="plus">+</button>
                </div>
                
                <!-- HIER IS DE EENHEID SELECT TERUG -->
                <select id="item-eenheid" required></select>
                
                <select id="item-vriezer" required>
                    <option value="" disabled selected>Kies een vriezer...</option> 
                </select>
                <select id="item-schuif" required>
                    <option value="" disabled selected>Kies eerst een vriezer...</option> 
                </select>
                
                <div class="form-grid-pair" style="grid-column: 1 / 3;">
                    <div class="form-field-group">
                        <label for="item-categorie" class="form-label">Categorie:</label>
                        <select id="item-categorie" required>
                            <option value="Geen">Geen categorie</option>
                            <option value="Groenten">Groenten</option>
                            <option value="Vlees">Vlees</option>
                            <option value="Vis">Vis</option>
                            <option value="Restjes">Restjes</option>
                            <option value="Brood">Brood</option>
                            <option value="Fruit">Fruit</option>
                            <option value="IJs">Ijs</option>
                            <option value="Saus">Saus</option>
                            <option value="Friet">Friet</option>
                            <option value="Ander">Ander</option>
                        </select>
                    </div>
                    <div class="form-field-group">
                        <label for="item-datum" class="form-label">Ingevroren op:</label>
                        <input type="date" id="item-datum" required>
                    </div>
                </div>
                
                <div style="grid-column: 1 / 3; display: flex; align-items: center; gap: 10px;">
                    <input type="checkbox" id="remember-drawer-check" style="width: auto;">
                    <label for="remember-drawer-check" style="margin: 0; font-weight: normal;">Onthoud vriezer en lade</label>
                </div>

                <button type="submit">Toevoegen</button>
            </form>
            
            <hr>
            
            <div class="search-container">
                <i class="fas fa-search"></i>
                <input type="text" id="search-bar" placeholder="Zoek een product...">
            </div>
            
            <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                <button id="btn-toggle-alles" class="btn-full-width-toggle" style="flex: 1; margin-bottom: 0;">
                    <i class="fas fa-plus-square"></i> Alles Openen
                </button>
                <button id="btn-toggle-mode" class="btn-toggle-mode" style="margin-bottom: 0;">
                    <i class="fas fa-bolt"></i> Verplaatsmodus
                </button>
            </div>
            
            <div class="vriezer-container" id="vriezer-lijsten-container"></div>
        </div>

        <!-- TAB 2: VOORRAADKAST (Nieuw) -->
        <div id="tab-voorraad" class="tab-content">
            <div style="text-align: center; padding: 40px; color: #777;">
                <i class="fas fa-box-open" style="font-size: 50px; margin-bottom: 20px;"></i>
                <h2>Voorraadkast</h2>
                <p>Hier kun je binnenkort je droge voorraad (pasta, rijst, blik) beheren.</p>
                <button class="btn-beheer" style="background-color: #ddd; color: #555; margin-top: 10px;">Binnenkort Beschikbaar</button>
            </div>
        </div>

        <!-- TAB 3: BOODSCHAPPENLIJST (Verplaatst uit modal) -->
        <div id="tab-boodschappen" class="tab-content">
            <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                <form id="add-shopping-item-form" class="input-with-button" style="flex-grow: 1;">
                    <input type="text" id="shopping-item-naam" placeholder="Nieuw item..." required style="height: 50px;">
                    <button type="submit" class="btn-beheer" style="width: 50px; height: 50px; padding: 0;">
                        <i class="fas fa-plus"></i>
                    </button>
                </form>
            </div>
            
            <div class="modal-header" style="margin-bottom: 10px;">
                <h3 style="margin: 0; border: none;">Mijn Lijst</h3>
                <button type="button" id="btn-clear-checked-shopping-items" class="btn-beheer" style="background-color: #d9534f; font-size: 13px;">
                    <i class="fas fa-check-double"></i> Vinkjes Wissen
                </button>
            </div>
            
            <ul id="shopping-list" class="shopping-list"></ul>
        </div>

        <!-- TAB 4: WEEKMENU (Verplaatst uit modal) -->
        <div id="tab-weekmenu" class="tab-content">
            <h3>Gerecht Inplannen</h3>
            <form id="add-weekmenu-form" style="margin-bottom: 20px;">
                <div style="display: flex; flex-direction: column; gap: 10px;">
                    <label for="weekmenu-datum" style="font-size: 0.9em; font-weight: bold;">Datum:</label>
                    <input type="date" id="weekmenu-datum" required>
                    
                    <input type="text" id="weekmenu-gerecht" placeholder="Wat eten we?" required>
                    
                    <input type="url" id="weekmenu-link" placeholder="Link naar recept (https://...)">
                    
                    <button type="submit" class="btn-beheer" style="width: 100%; margin-top: 5px;">
                        <i class="fas fa-plus"></i> Inplannen
                    </button>
                </div>
            </form>
            
            <hr>
            
            <div class="modal-header" style="margin-bottom: 10px;">
                <h3 style="margin: 0; border: none;">Op de planning</h3>
                <button type="button" id="btn-clear-old-weekmenu" class="btn-beheer" style="background-color: #d9534f; font-size: 13px;">
                    <i class="fas fa-history"></i> Oude wissen
                </button>
            </div>
            
            <ul id="weekmenu-list" class="shopping-list"></ul>
        </div>

    </div>

    <!-- Bulk Actie Balk -->
    <div id="bulk-action-bar" class="bulk-action-bar">
        <span class="bulk-info" id="bulk-count">0 items</span>
        <div class="bulk-controls">
            <select id="bulk-target-vriezer" class="bulk-select">
                <option value="" disabled selected>Naar vriezer...</option>
            </select>
            <select id="bulk-target-lade" class="bulk-select">
                <option value="" disabled selected>Naar lade...</option>
            </select>
            <button id="btn-bulk-move" class="btn-bulk-move">Verplaatsen</button>
        </div>
    </div>
    
    <!-- MODALS (Edit, Move Purchased, Beheer, etc. blijven hetzelfde) -->
    <!-- Edit Item Modal -->
    <div id="edit-modal" class="modal-overlay">
        <div class="modal-content">
            <h2>Item Bewerken</h2>
            <form id="edit-item-form">
                <input type="hidden" id="edit-item-id">
                
                <label for="edit-item-naam">Naam & Emoji:</label>
                <div style="display: flex; gap: 10px;">
                    <input type="text" id="edit-item-emoji" class="emoji-trigger" style="width: 50px; height: 50px; flex-grow: 0; flex-shrink: 0; text-align: center; border-radius: 5px; border: 1px solid #ccc; padding: 0; font-size: 20px; cursor: pointer;" placeholder="ðŸ·ï¸" readonly>
                    <input type="text" id="edit-item-naam" required style="flex-grow: 1; height: 50px;">
                </div>
                
                <label for="edit-item-aantal" style="margin-top: 15px;">Aantal:</label>
                <div class="aantal-wrapper">
                    <button type="button" class="aantal-btn" data-action="minus" aria-label="Verminder aantal">-</button>
                    <input type="number" id="edit-item-aantal" step="0.25" min="0.25" required>
                    <button type="button" class="aantal-btn" data-action="plus" aria-label="Verhoog aantal">+</button>
                </div>

                <label for="edit-item-eenheid">Eenheid:</label>
                <select id="edit-item-eenheid" required></select>
                
                <label for="edit-item-vriezer">Vriezer:</label>
                <select id="edit-item-vriezer" required></select>
                
                <label for="edit-item-schuif">Schuif/Lade:</label>
                <select id="edit-item-schuif" required></select>
                
                <label for="edit-item-categorie">Categorie:</label>
                <select id="edit-item-categorie" required>
                    <option value="Geen">Geen categorie</option>
                    <option value="Groenten">Groenten</option>
                    <option value="Vlees">Vlees</option>
                    <option value="Vis">Vis</option>
                    <option value="Restjes">Restjes</option>
                    <option value="Brood">Brood</option>
                    <option value="Fruit">Fruit</option>
                    <option value="IJs">IJs</option>
                    <option value="Saus">Saus</option>
                    <option value="Friet">Friet</option>
                    <option value="Ander">Ander</option>
                </select>
                
                <label for="edit-item-datum">Ingevroren op:</label>
                <input type="date" id="edit-item-datum" required>
                
                <div class="modal-buttons">
                    <button type="submit" class="btn-save">Opslaan</button>
                    <button type="button" id="btn-cancel" class="btn-cancel">Annuleren</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Move Purchased Modal -->
    <div id="move-purchased-modal" class="modal-overlay">
        <div class="modal-content">
            <h2>Gekocht & Opbergen</h2>
            <p>Waar heb je <strong><span id="move-purchased-naam"></span></strong> gelegd?</p>
            <form id="move-purchased-form">
                <input type="hidden" id="move-purchased-temp-id">
                <input type="hidden" id="move-purchased-item-naam">
                
                <label>Vriezer:</label>
                <select id="move-purchased-vriezer" required style="margin-bottom: 10px;">
                    <option value="" disabled selected>Kies vriezer...</option>
                </select>
                
                <label>Lade:</label>
                <select id="move-purchased-lade" required style="margin-bottom: 10px;">
                    <option value="" disabled selected>Kies lade...</option>
                </select>
                
                <label>Aantal & Eenheid:</label>
                <div style="display: flex; gap: 10px;">
                    <input type="number" id="move-purchased-aantal" value="1" style="width: 80px;" required>
                    <select id="move-purchased-eenheid" style="flex-grow: 1;"></select>
                </div>
                
                <label style="margin-top: 10px;">Categorie & Emoji:</label>
                <div style="display: flex; gap: 10px;">
                    <select id="move-purchased-categorie" style="flex-grow: 1; height: 50px;">
                         <option value="Geen">Geen categorie</option>
                         <option value="Groenten">Groenten</option>
                         <option value="Vlees">Vlees</option>
                         <option value="Vis">Vis</option>
                         <option value="Restjes">Restjes</option>
                         <option value="Brood">Brood</option>
                         <option value="Fruit">Fruit</option>
                         <option value="IJs">IJs</option>
                         <option value="Saus">Saus</option>
                         <option value="Friet">Friet</option>
                         <option value="Ander">Ander</option>
                    </select>
                    <input type="text" id="move-purchased-emoji" class="emoji-trigger" placeholder="ðŸ·ï¸" style="width: 50px; height: 50px; flex-grow: 0; flex-shrink: 0; text-align: center; border-radius: 5px; border: 1px solid #ccc; padding: 0; font-size: 20px; cursor: pointer;" readonly>
                </div>

                <div class="modal-buttons">
                    <button type="submit" class="btn-save">Opslaan in Vriezer</button>
                    <button type="button" id="btn-cancel-move-purchased" class="btn-cancel">Annuleren</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- (Andere modals zoals Vriezer Beheer, QR, Scan, Wissel Account, Profiel, Notificatie, Geschiedenis blijven hier, ongewijzigd, maar wel nodig in het bestand) -->
    <!-- ... (Ik laat de overige modals even weg om de lengte te beperken, maar ze moeten er wel in blijven zitten zoals in je vorige bestand) ... -->
    <!-- Ik zal voor de zekerheid de essentiÃ«le modals toevoegen -->
    
    <div id="vriezer-beheer-modal" class="modal-overlay"><div class="modal-content modal-groot"><div class="modal-header"><h2>Beheer</h2><button id="btn-sluit-beheer" class="btn-cancel">Sluiten</button></div><div class="beheer-container"><div class="beheer-kolom"><h3>Vriezers</h3><form id="add-vriezer-form"><input type="text" id="vriezer-naam" placeholder="Naam" required><button type="submit">Toevoegen</button></form><hr><ul id="vriezer-beheer-lijst"></ul></div><div class="beheer-kolom"><h3 id="lades-beheer-titel">Kies vriezer...</h3><form id="add-lade-form" style="display:none;"><input type="text" id="lade-naam" placeholder="Naam" required><button type="submit">Toevoegen</button></form><hr id="lades-beheer-hr" style="display:none;"><ul id="lade-beheer-lijst"></ul></div><div class="beheer-kolom"><h3>Eenheden</h3><form id="add-eenheid-form"><input type="text" id="eenheid-naam" placeholder="bv. Zak" required><button type="submit" style="background-color:#f0ad4e;">Toevoegen</button></form><hr><ul id="eenheid-beheer-lijst" class="shared-list"></ul></div></div></div></div>
    <div id="scan-modal" class="modal-overlay"><div class="modal-content"><h2>Scan</h2><div id="barcode-scanner-container"></div><button id="btn-stop-scan" class="btn-cancel">Stop</button></div></div>
    <div id="qr-modal" class="modal-overlay"><div class="modal-content"><h2>QR Code</h2><canvas id="qr-canvas"></canvas><p id="qr-lade-naam"></p><div class="modal-buttons"><button id="btn-print-qr" class="btn-beheer btn-print">Print</button><button id="btn-sluit-qr" class="btn-cancel">Sluiten</button></div></div></div>
    <div id="switch-account-modal" class="modal-overlay"><div class="modal-content modal-groot"><h2>Wissel</h2><button id="btn-sluit-switch-account" class="btn-cancel">Sluiten</button><div class="admin-huidig-beheer"><h3 id="switch-account-titel"></h3><button id="switch-terug-knop" class="btn-beheer" style="display:none;">Terug</button></div><hr><div class="beheer-container"><div class="beheer-kolom" id="user-switch-section"><ul id="user-shared-lijst" class="shared-list"></ul></div><div class="beheer-kolom" id="admin-switch-section" style="display:none;"><ul id="admin-user-lijst" class="shared-list"></ul></div></div></div></div>
    <div id="profile-modal" class="modal-overlay"><div class="modal-content"><div class="modal-header"><h2>Profiel</h2><button id="btn-sluit-profile" class="btn-cancel">Sluiten</button></div><div class="profile-header"><span id="profile-email"></span></div><ul class="profile-menu-list"><li><button id="profile-vriezer-beheer-btn" class="profile-menu-btn">Beheer</button></li><li><button id="profile-share-btn" class="profile-menu-btn">Delen</button></li><li><button id="print-btn" class="profile-menu-btn">Print</button></li><li><button id="profile-history-btn" class="profile-menu-btn">Geschiedenis</button></li><li><button id="export-data-btn" class="profile-menu-btn">Export</button></li></ul><hr><button id="logout-btn" class="btn-beheer btn-logout">Uitloggen</button></div></div>
    <div id="notificatie-modal" class="modal-overlay"><div class="modal-content"><h2>Let op!</h2><ul id="notificatie-lijst" class="notificatie-lijst"></ul><button id="btn-sluit-notificatie" class="btn-cancel">Sluiten</button></div></div>
    <div id="share-modal" class="modal-overlay"><div class="modal-content modal-groot"><h2>Delen</h2><button id="btn-sluit-share" class="btn-cancel">Sluiten</button><div class="beheer-container"><div class="beheer-kolom"><form id="share-invite-form"><input type="email" id="share-email" required><select id="share-role"><option value="editor">Editor</option><option value="viewer">Viewer</option></select><button type="submit">Nodig uit</button></form></div><div class="beheer-kolom"><ul id="share-huidige-lijst" class="shared-list"></ul></div></div></div></div>
    <div id="accept-share-modal" class="modal-overlay"><div class="modal-content"><h2>Uitnodigingen</h2><ul id="accept-share-lijst" class="accept-share-list"></ul><button id="btn-sluit-accept-share" class="btn-cancel">Later</button></div></div>
    <div id="history-modal" class="modal-overlay"><div class="modal-content modal-groot"><h2>Geschiedenis</h2><button id="btn-sluit-history" class="btn-cancel">Sluiten</button><button id="btn-clear-history" class="btn-beheer btn-logout">Wis</button><ul id="history-list" class="shared-list"></ul></div></div>
    
    <!-- Emoji Picker Modal -->
    <div id="emoji-picker-modal" class="modal-overlay" style="z-index: 2000;">
        <div class="modal-content" style="width: auto; padding: 10px;">
            <div class="modal-header" style="justify-content: flex-end; margin-bottom: 5px;">
                <button type="button" id="btn-sluit-emoji" class="btn-cancel" style="padding: 5px 10px; font-size: 14px;">Sluiten</button>
            </div>
            <emoji-picker id="emoji-picker" class="light"></emoji-picker>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
    <script src="app.js"></script>
    
    <!-- Inline script voor tabs en emoji -->
    <script>
        // Tabs Logica
        const navItems = document.querySelectorAll('.nav-item');
        const tabContents = document.querySelectorAll('.tab-content');
        const pageTitle = document.getElementById('page-title');

        navItems.forEach(item => {
            item.addEventListener('click', () => {
                // Actieve class verplaatsen
                navItems.forEach(nav => nav.classList.remove('active'));
                item.classList.add('active');

                // Content tonen
                const targetId = item.dataset.tab;
                tabContents.forEach(content => content.classList.remove('active'));
                document.getElementById(targetId).classList.add('active');
                
                // Titel updaten
                pageTitle.textContent = item.querySelector('span').textContent;
            });
        });

        // Emoji Picker Logica
        const emojiPickerModal = document.getElementById('emoji-picker-modal');
        const emojiPicker = document.querySelector('emoji-picker');
        const sluitEmojiBtn = document.getElementById('btn-sluit-emoji');
        let currentEmojiInput = null;

        function openEmojiPicker(inputElement) {
            currentEmojiInput = inputElement;
            emojiPickerModal.classList.add('show');
        }

        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('emoji-trigger')) {
                openEmojiPicker(e.target);
            }
        });

        sluitEmojiBtn.addEventListener('click', () => {
            emojiPickerModal.classList.remove('show');
            currentEmojiInput = null;
        });

        emojiPickerModal.addEventListener('click', (e) => {
            if (e.target === emojiPickerModal) {
                emojiPickerModal.classList.remove('show');
                currentEmojiInput = null;
            }
        });

        emojiPicker.addEventListener('emoji-click', event => {
            if (currentEmojiInput) {
                currentEmojiInput.value = event.detail.unicode;
                currentEmojiInput.dispatchEvent(new Event('change')); 
            }
            emojiPickerModal.classList.remove('show');
            currentEmojiInput = null;
        });
    </script>

</body>
</html>